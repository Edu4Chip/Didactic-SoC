/*
 * Name: logo
 * Contributor(s):
 *    - Arto Oinonen (arto.oinonen@tuni.fi)
 * Description:
 *    - hello world for Didactic SoC
 * Notes:
 *    - 
 */
//#include "gpio.h"
//#include "soc_ctrl.h"
#include "uart.h"
#include <stdio.h>

#define ADDR 0x01030000
#define CTRL_BASE 0x01040000
#define PMOD_OFFSET     0x24

#define PMOD_CTRL *( volatile uint32_t* )(CTRL_BASE+PMOD_OFFSET)
#define PAD_CFG_GPIO0 *(volatile uint32_t*)(CTRL_BASE + 0x4C)
#define PAD_CFG_GPIO1 *(volatile uint32_t*)(CTRL_BASE + 0x50)
#define PAD_CFG_GPIO2 *(volatile uint32_t*)(CTRL_BASE + 0x54)
#define PAD_CFG_GPIO3 *(volatile uint32_t*)(CTRL_BASE + 0x58)
#define PAD_CFG_GPIO8 *(volatile uint32_t*)(CTRL_BASE + 0x6C)
#define PAD_CFG_GPIO9 *(volatile uint32_t*)(CTRL_BASE + 0x70)
#define PAD_CFG_GPIO10 *(volatile uint32_t*)(CTRL_BASE + 0x74)
#define PAD_CFG_GPIO11 *(volatile uint32_t*)(CTRL_BASE + 0x78)
#define PAD_OUT *(volatile uint32_t *)(ADDR+0x0C)
#define PAD_IN  *(volatile uint32_t *)(ADDR+0x08)

const char* e4c[] = {  
// 80
"                **  .*:  -*   *+   *   **   *:  =*   *+  :*:  =*                ", "                ##  .#-  =#   #*   #   ##   #-  +#   ##  :#:  +#                ", "                ##  .#-  =#   #*   #   ##   #-  +#   ##  :#:  +#                ", "                ##  .#-  =#   #*   #   ##   #-  +#   ##  :#:  +#                ", "          :##########################################################:          ", "        :####*.                                                  .+####-        ", "       .###-   .================================================.   .###.       ", "       *###  .####################################################.  ####       ", "+##########  ######################################################  *#########*", "       *###  #####====##### ##########+=###=--=## ####+-###########  *###       ", ":******####  ##### :####*:* ##+##+###:.:#= +##*## *:##*+#*+=:######  *###******-", " ......*###  ##### :+##  #* ## ## #+.*::#= ###### #* #- #= ## =####  *###...... ", " ......*###  #####    #*  . ##. . #***::##-.  .=# ## #- #=   :#####  *###:::::: ", ".++++++####  ############################################= ########  *###++++++:", "       *###  #########################=--=#########################  *###       ", "+##########  ###################**.          .**###################  *#########*", "       *###  ###############:.                    .:###############  *###       ", "-++++++####  ########*=-                                -=*########  *###++++++-", "       *###  ########-          :+############*-          -########  *###       ", " ......*###  ##########* *+-+:.                   :*-+*############  *###:::::: ", ":++++++####  ##########+ ####                      +###############  *###++++++-", "       *###  ##########* ####         :--:.        +###############  *###       ", "+##########  ##########. -### .=*#######*#######=: +###############  *#########+", "       *###  ##########: :#########=+##+-##+:*#####################  *###       ", "+******####  #########*   #########################################  *###******+", "       *###  ######+=     ######=+############*=###################  *###       ", " ......*###  #######+    :#########################################  *###...... ", ".::::::*###  ##################-+##############*=##################  *###:::::::", "       *###  ######################################################  *###       ", "+##########  ###################:=############+.###################  *#########*", "       *###  ######################==######==*#####################  *###       ", "*##########  ##########################-:##########################  *#########*", "       *###  .####################################################:  *###       ", "       .###.   -=++++++++++++++++++++++++++++++++++++++++++++++=-   .###:       ", "        +####:                                                    .####+        ", "          =##########################################################+.         ", "              ::##::-#=::+#:::#*::-#:::##:::#+::*#:::##::=#=::*#::              ", "                ##  .#-  =#   #*   #   ##   #-  +#   ##  :#:  +#                ", "                ##  .#-  =#   #*   #   ##   #-  +#   ##  :#:  +#                ", "                #*  .#:  =#   #+   #   *#   #-  +#   #*  :#:  +#                "
};

const char* didactic[] = {
"Didactic SoC\r\n",
"TAU: Common chip template",
"DTU: Leros CPU",
"IMT: Crypto-accelerator for the Ascon AEAD family",
"KTH: 16-point FFT implementation",
"TUM: Accelerator for matrix multiplication",
};

int wait(int cycles) {
    for (int i=0;i<cycles;i++) {
  		asm("nop");
    }
  return 0;
}

int main() {

  int e4clines = sizeof(e4c) / sizeof(e4c[0]);

  // Sysctrl to GPIO
  PMOD_CTRL = 5;
  PAD_CFG_GPIO0  &= ~1u;
  PAD_CFG_GPIO1  &= ~1u;
  PAD_CFG_GPIO2  &= ~1u;
  PAD_CFG_GPIO3  &= ~1u;

  uart_init(25000000,38400);
//  uart_print("Hello from Didactic SoC!\r\n");

  while (1) {
    // Logo
    for (int i = 0; i < e4clines; i++) {
      uart_print(e4c[i]);
      uart_print("\r\n");
      PAD_OUT += 1 & 0xF;
    }
    // Clear
    wait(1000000);
    for (int i = 0; i < e4clines +2; i++) {
      uart_print("\r\n");
    }

  }

  return 0;
}
